let FormAutoFill=new Vue({el:"#app",data:{gas:"https://script.google.com/macros/s/AKfycbz09ID5jpQ6GByn6oyfQlTzZrYIZONT2qlJ3zWadQ4-b2OlhzjztDzo4ObE_UEJK99C/exec",main_date:"",persons:{},person:{classroom:[],classroomnum:[]},sessions:[],formAction:"https://docs.google.com/forms/u/0/d/e/1FAIpQLSdmjNIW62KESvCeQdkFPjYqFJddL2yLP-_GnG14IfdhN9QYag/formResponse",input:{main_date:"entry.1728672130",category:"entry.1482655790",borrower:"entry.1839271513",message:"entry.976702063",classroom:"entry.612910922",num:"entry.2022607349",end_date:"entry.1438188391"},loading:!1},methods:{clearClassroom(){this.person.end_date=void 0,this.person.classroom=[]},clearDate(){this.main_date=void 0,this.person.end_date=void 0,this.person.classroom=[],this.sessions=[]},submit(){if(void 0!==this.main_date&&void 0!==this.person.category&&void 0!==this.person.borrower&&void 0!==this.person.message&&0<this.person.classroom.length&&void 0!==this.person.num&&void 0!==this.person.end_date){if("iPad"===this.person.category){this.person.classroomcheck=this.person.classroom,this.person.classroomchecknum=[];for(var n of this.person.classroomcheck)for(let s=0;s<this.person.classroomnum.length;s+=2)if(this.person.classroomnum[s]===n){this.person.classroomchecknum.push(this.person.classroomnum[s+1]);break}this.person.minNumber=Math.min(...this.person.classroomchecknum)}var s;"iPad"===this.person.category&&this.person.minNumber<this.person.num?alert("借用數量超過剩餘數量，請確認使用課堂及數量！"):(s=["第一節","第二節","第三節","第四節","第五節","學藝營","第六節","第七節","安親班"].filter(s=>this.person.classroom.includes(s)),s=`${this.input.main_date}=${this.main_date}&${this.input.category}=${this.person.category}&${this.input.borrower}=${this.person.borrower}&${this.input.message}=${this.person.message}&${this.input.classroom}=${s}&${this.input.num}=${this.person.num}&${this.input.end_date}=`+this.person.end_date,fetch(this.formAction+"?"+s,{method:"POST"}).catch(s=>{alert("提交成功。"),this.main_date="",this.person={classroom:[],classroomnum:[]},this.sessions=[],location.reload()}))}else alert("請填寫所有項目！")}},watch:{main_date:function(s){var n;let e=new Date(s).getUTCDay();void 0!==s&&"iPad"===this.person.category?(this.loading=!0,n=this.gas+"?id="+this.main_date,fetch(n,{method:"POST"}).then(s=>s.json()).then(s=>{this.person.classroomnum=s.classroomnum,3===e?this.sessions=[{name:"第一節",remaining:"剩餘數量："+this.person.classroomnum[1]},{name:"第二節",remaining:"剩餘數量："+this.person.classroomnum[3]},{name:"第三節",remaining:"剩餘數量："+this.person.classroomnum[5]},{name:"第四節",remaining:"剩餘數量："+this.person.classroomnum[7]},{name:"第五節",remaining:"剩餘數量："+this.person.classroomnum[9]},{name:"學藝營",remaining:"剩餘數量："+this.person.classroomnum[11]}]:this.sessions=[{name:"第一節",remaining:"剩餘數量："+this.person.classroomnum[1]},{name:"第二節",remaining:"剩餘數量："+this.person.classroomnum[3]},{name:"第三節",remaining:"剩餘數量："+this.person.classroomnum[5]},{name:"第四節",remaining:"剩餘數量："+this.person.classroomnum[7]},{name:"第五節",remaining:"剩餘數量："+this.person.classroomnum[9]},{name:"第六節",remaining:"剩餘數量："+this.person.classroomnum[13]},{name:"第七節",remaining:"剩餘數量："+this.person.classroomnum[15]},{name:"安親班",remaining:"剩餘數量："+this.person.classroomnum[17]}],this.loading=!1}).catch(s=>{this.loading=!1,alert('網站發生錯誤，按"確定"重新整理網頁'),location.reload()})):void 0!==s&&(3===e?this.sessions=[{name:"第一節",remaining:""},{name:"第二節",remaining:""},{name:"第三節",remaining:""},{name:"第四節",remaining:""},{name:"第五節",remaining:""},{name:"學藝營",remaining:""}]:this.sessions=[{name:"第一節",remaining:""},{name:"第二節",remaining:""},{name:"第三節",remaining:""},{name:"第四節",remaining:""},{name:"第五節",remaining:""},{name:"第六節",remaining:""},{name:"第七節",remaining:""},{name:"安親班",remaining:""}])}}});
